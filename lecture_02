## The data comes originally from RITA where it is described in detail. You can download the data there, or from the bzipped csv files listed below. These files have derivable variables removed, are packaged in yearly chunks and have been more heavily compressed than the originals.

# ref : http://stat-computing.org/dataexpo/2009/the-data.html

# Data description
  Name	          Description
1	Year	          1987-2008
2	Month	          1-12
3	DayofMonth	    1-31
4	DayOfWeek	      1 (Monday) - 7 (Sunday)
5	DepTime	        actual departure time (local, hhmm)
6	CRSDepTime	    scheduled departure time (local, hhmm)
7	ArrTime	        actual arrival time (local, hhmm)
8	CRSArrTime	    scheduled arrival time (local, hhmm)
9	UniqueCarrier	  unique carrier code
10	FlightNum	      flight number
11	TailNum	        plane tail number
12	ActualElapsedTime	  in minutes
13	CRSElapsedTime	  in minutes
14	AirTime	      in minutes
15	ArrDelay	    arrival delay, in minutes
16	DepDelay	    departure delay, in minutes
17	Origin	      origin IATA airport code
18	Dest	        destination IATA airport code
19	Distance	    in miles
20	TaxiIn	      taxi in time, in minutes
21	TaxiOut	      taxi out time in minutes
22	Cancelled	    was the flight cancelled?
23	CancellationCode	  reason for cancellation (A = carrier, B = weather, C = NAS, D = security)
24	Diverted	    1 = yes, 0 = no
25	CarrierDelay	    in minutes
26	WeatherDelay	    in minutes
27	NASDelay	    in minutes
28	SecurityDelay	    in minutes
29	LateAircraftDelay	    in minutes

1. File 내용 확인하기
cd RITA_Data
head 2000/2000.csv

1. HDFS 로 업로드 하기
hadoop fs -put RITA_Data /stage-data/.

2. file 확인하기
hadoop fs -ls -R /stage-data/RITA_Data

3. Hive 테이블 생성하기
----------------------------------------------------------------------------------------------------------
beeline 
!connect jdbc:hive2://localhost:10000/default

use lecture;
CREATE DATABASE lecture;
CREATE EXTERNAL TABLE `lecture.flight_data_tmp`(
   `year` int,
   `month` int,
   `day` int,       
   `day_of_week` int,
   `dep_time` int,
   `crs_dep_time` int,
   `arr_time` int,
   `crs_arr_time` int,
   `unique_carrier` string,
   `flight_num` int,
   `tail_num` string,
   `actual_elapsed_time` int,
   `crs_elapsed_time` int,
   `air_time` int,
   `arr_delay` int,
   `dep_delay` int,
   `origin` string,
   `dest` string,
   `distance` int,
   `taxi_in` int,
   `taxi_out` int,
   `cancelled` int,
   `cancellation_code` string,
   `diverted` int,
   `carrier_delay` string,
   `weather_delay` string,
   `nas_delay` string,
   `security_delay` string,
   `late_aircraft_delay` string)
 PARTITIONED BY (`etl_year` string)
 ROW FORMAT DELIMITED
   FIELDS TERMINATED BY ','
 STORED AS INPUTFORMAT
   'org.apache.hadoop.mapred.TextInputFormat'
 OUTPUTFORMAT
   'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat'
 LOCATION
   'hdfs://sandbox-hdp.hortonworks.com:8020/user/hive/warehouse/lecture.db/flight_data';
-------------------------------------------------------------------------------------------------------
